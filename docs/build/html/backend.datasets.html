

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Package: backend.datasets &mdash; COVID Community Response v1.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Package: backend.scrapers" href="backend.scrapers.html" />
    <link rel="prev" title="Package: backend" href="backend.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> COVID Community Response
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Data Processing Packages:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="backend.html">Package: backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="backend.scrapers.html">Package: backend.scrapers</a></li>
<li class="toctree-l1"><a class="reference internal" href="backend.tweets.html">Package: backend.tweets</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Package: backend.datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-backend.datasets.dataset">dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-backend.datasets.live">live</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-backend.datasets.static">static</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-backend.datasets.static_source_datasets">static_source_datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-backend.datasets.generate_gp_online">generate_gp_online</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">COVID Community Response</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="backend.html">Package: backend</a> &raquo;</li>
        
      <li>Package: backend.datasets</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/backend.datasets.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="package-backend-datasets">
<h1>Package: backend.datasets<a class="headerlink" href="#package-backend-datasets" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules:<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-backend.datasets.dataset">
<span id="dataset"></span><h2>dataset<a class="headerlink" href="#module-backend.datasets.dataset" title="Permalink to this headline">¶</a></h2>
<p>This module contains the classes used to standardise, format and combine the data sources used to
create the map.</p>
<dl class="simple">
<dt>The classes defined in this module are:</dt><dd><p>DataResolution
DataFrequency</p>
</dd>
<dt>The dataclasses defined in this module are:</dt><dd><p>Dataset
MasterDataset</p>
</dd>
</dl>
<dl class="py class">
<dt id="backend.datasets.dataset.DataFrequency">
<em class="property">class </em><code class="sig-prename descclassname">backend.datasets.dataset.</code><code class="sig-name descname">DataFrequency</code><a class="headerlink" href="#backend.datasets.dataset.DataFrequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Defines a time resolution.</p>
<p class="rubric">Example</p>
<p><cite>DataFrequency.LIVE</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Enum</strong> (<em>str</em>) – Define the DataFrequency as “live” or “static”</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="backend.datasets.dataset.DataFrequency.LIVE">
<code class="sig-name descname">LIVE</code><em class="property"> = 'live'</em><a class="headerlink" href="#backend.datasets.dataset.DataFrequency.LIVE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.DataFrequency.STATIC">
<code class="sig-name descname">STATIC</code><em class="property"> = 'static'</em><a class="headerlink" href="#backend.datasets.dataset.DataFrequency.STATIC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="backend.datasets.dataset.DataResolution">
<em class="property">class </em><code class="sig-prename descclassname">backend.datasets.dataset.</code><code class="sig-name descname">DataResolution</code><a class="headerlink" href="#backend.datasets.dataset.DataResolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Defines a geographic resolution.</p>
<p class="rubric">Example</p>
<p><cite>DataResolution.LA</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Enum</strong> (<em>str</em>) – Define the DataResolution as “LA”, “LSOA”, “MSOA”.</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="backend.datasets.dataset.DataResolution.LA">
<code class="sig-name descname">LA</code><em class="property"> = ('LA', 'Local Authority')</em><a class="headerlink" href="#backend.datasets.dataset.DataResolution.LA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.DataResolution.LSOA">
<code class="sig-name descname">LSOA</code><em class="property"> = ('LSOA', 'Lower Super Output Area')</em><a class="headerlink" href="#backend.datasets.dataset.DataResolution.LSOA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.DataResolution.MSOA">
<code class="sig-name descname">MSOA</code><em class="property"> = ('MSOA', 'Middle Super Output Area')</em><a class="headerlink" href="#backend.datasets.dataset.DataResolution.MSOA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="backend.datasets.dataset.Dataset">
<em class="property">class </em><code class="sig-prename descclassname">backend.datasets.dataset.</code><code class="sig-name descname">Dataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">pandas.core.frame.DataFrame</span></em>, <em class="sig-param"><span class="n">res</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#backend.datasets.dataset.DataResolution" title="backend.datasets.dataset.DataResolution">backend.datasets.dataset.DataResolution</a></span></em>, <em class="sig-param"><span class="n">key_col</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">key_is_code</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">csv_name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">keep_cols</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bracketed_data_cols</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rename</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#backend.datasets.dataset.Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to handle transformations to source datasets, returning them
in a standardised format.</p>
<dl class="py attribute">
<dt id="backend.datasets.dataset.Dataset.data">
<code class="sig-name descname">data</code><a class="headerlink" href="#backend.datasets.dataset.Dataset.data" title="Permalink to this definition">¶</a></dt>
<dd><p>The source dataset to standardise. Expected to have a row for each
goegraphic area with at least one column defining the area name or code.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.Dataset.res">
<code class="sig-name descname">res</code><a class="headerlink" href="#backend.datasets.dataset.Dataset.res" title="Permalink to this definition">¶</a></dt>
<dd><p>The DataResolution type of the data. See the class for options.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#backend.datasets.dataset.DataResolution" title="backend.datasets.dataset.DataResolution">DataResolution</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.Dataset.key_col">
<code class="sig-name descname">key_col</code><a class="headerlink" href="#backend.datasets.dataset.Dataset.key_col" title="Permalink to this definition">¶</a></dt>
<dd><p>The column name of the col containing the unique area key.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.Dataset.key_is_code">
<code class="sig-name descname">key_is_code</code><a class="headerlink" href="#backend.datasets.dataset.Dataset.key_is_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not the key_col is an area code or area name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.Dataset.csv_name">
<code class="sig-name descname">csv_name</code><a class="headerlink" href="#backend.datasets.dataset.Dataset.csv_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the csv to write out to, if called. The resolution is
automatically prepended the resolution to the name if written.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.Dataset.keep_cols">
<code class="sig-name descname">keep_cols</code><a class="headerlink" href="#backend.datasets.dataset.Dataset.keep_cols" title="Permalink to this definition">¶</a></dt>
<dd><p>List of columns to keep in the standardised dataset. If columns have been
renamed, use the names given after renaming. Must also include the renamed
key_col with its formal name (‘LSOA11CD’, ‘LSOA11NM’, ‘lad19cd’, ‘lad19nm’).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.Dataset.bracketed_data_cols">
<code class="sig-name descname">bracketed_data_cols</code><a class="headerlink" href="#backend.datasets.dataset.Dataset.bracketed_data_cols" title="Permalink to this definition">¶</a></dt>
<dd><p>List of columns that have data in the format <cite>NUMBER (PERCENTAGE)</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.Dataset.rename">
<code class="sig-name descname">rename</code><a class="headerlink" href="#backend.datasets.dataset.Dataset.rename" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary in format {‘old_name’ : ‘new_name’ } for columns to be renamed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">std_data\_</code></dt>
<dd><p>Standardised data, which will have a name and code column, the columns chosen to
keep whose contents and column names may be updated based on the args provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id0">
<code class="sig-name descname">bracketed_data_cols</code><em class="property">: list</em><em class="property"> = None</em><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="backend.datasets.dataset.Dataset.clean_bracketed_data">
<code class="sig-name descname">clean_bracketed_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backend.datasets.dataset.Dataset.clean_bracketed_data" title="Permalink to this definition">¶</a></dt>
<dd><p>For a df with columns in the format ‘NUMBER (PERCENTAGE)’ this function extracts the
data into two new columns and deletes the original column.</p>
<p class="rubric">Notes</p>
<p>The two new columns will be named the same as the original column, but with <cite>_count</cite>
or <cite>_pct</cite> appended.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>DataFrame with each col replaced by two new columns with the count and percentage.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="backend.datasets.dataset.Dataset.clean_keys">
<em class="property">static </em><code class="sig-name descname">clean_keys</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">res</span></em>, <em class="sig-param"><span class="n">key_col</span></em>, <em class="sig-param"><span class="n">key_is_code</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#backend.datasets.dataset.Dataset.clean_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures df key column (i.e column used for joining) is correctly formatted
for joins in the next steps. Accepts key as a code or name, at LA or LSOA level.
Will rename key column if it is not the standard name.</p>
<p class="rubric">Notes</p>
<p>Renaming of the key columns depends on the DataResolution.
For LSOA they will be <cite>LSOA11CD</cite> and <cite>LSOA11NM</cite> for code and name respectively.
For LA they will be <cite>lad19cd</cite> and <cite>ladnm19</cite> respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Dataframe to be cleaned</p></li>
<li><p><strong>res</strong> (<a class="reference internal" href="#backend.datasets.dataset.DataResolution" title="backend.datasets.dataset.DataResolution"><em>DataResolution</em></a>) – Accepts ‘LA’ or ‘LSOA’ as resolution of the data</p></li>
<li><p><strong>key_col</strong> (<em>[</em><em>type</em><em>]</em>) – Name of column containing the code or name</p></li>
<li><p><strong>key_is_code</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True the key_col is a code. If false, key_col is
a name. By default True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns dataframe with key_col stripped of whitespace, filted
to only Welsh areas and renamed for consistency.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – When the number of rows after merging on the new key column names cannot
    match the DataResolution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id1">
<code class="sig-name descname">csv_name</code><em class="property">: str</em><em class="property"> = None</em><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="backend.datasets.dataset.Dataset.csv_path">
<code class="sig-name descname">csv_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backend.datasets.dataset.Dataset.csv_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a name to output to csv.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>csv_name preppended with the data resolution and appended with .csv</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id2">
<code class="sig-name descname">data</code><em class="property">: pd.DataFrame</em><em class="property"> = None</em><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="backend.datasets.dataset.Dataset.is_standardised">
<em class="property">property </em><code class="sig-name descname">is_standardised</code><a class="headerlink" href="#backend.datasets.dataset.Dataset.is_standardised" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns bool of whether the standardised data has been generated.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id3">
<code class="sig-name descname">keep_cols</code><em class="property">: list</em><em class="property"> = None</em><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id4">
<code class="sig-name descname">key_col</code><em class="property">: str</em><em class="property"> = None</em><a class="headerlink" href="#id4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id5">
<code class="sig-name descname">key_is_code</code><em class="property">: bool</em><em class="property"> = None</em><a class="headerlink" href="#id5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="backend.datasets.dataset.Dataset.read_keys">
<code class="sig-name descname">read_keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backend.datasets.dataset.Dataset.read_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads and returns the LSOA and LA geopandas dataframes as constants ‘LSOA’, ‘LA’.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id6">
<code class="sig-name descname">rename</code><em class="property">: dict</em><em class="property"> = None</em><a class="headerlink" href="#id6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id7">
<code class="sig-name descname">res</code><em class="property">: DataResolution</em><em class="property"> = None</em><a class="headerlink" href="#id7" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="backend.datasets.dataset.Dataset.standardise">
<code class="sig-name descname">standardise</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backend.datasets.dataset.Dataset.standardise" title="Permalink to this definition">¶</a></dt>
<dd><p>Based on attributes, applies the correct functions to standardise the datasets.</p>
<p>The function will set <a href="#id12"><span class="problematic" id="id13">self.std_data_</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>This function will return the class instance.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#backend.datasets.dataset.Dataset" title="backend.datasets.dataset.Dataset">Dataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="backend.datasets.dataset.Dataset.standardise_keys">
<code class="sig-name descname">standardise_keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backend.datasets.dataset.Dataset.standardise_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Given dataframe and chosen cols, will use LA or LSOA geopandas dataframes to create
standardised columns for area codes and names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>self.data with standardised key codes and names. If keep_cols is used then only
those columns will be returned.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Exception</strong> – When the number of rows generated does not match the DataResolution</p></li>
<li><p><strong>ValueError</strong> – When the DataResolution is not LA or LSOA</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="backend.datasets.dataset.Dataset.standardised_data">
<em class="property">property </em><code class="sig-name descname">standardised_data</code><a class="headerlink" href="#backend.datasets.dataset.Dataset.standardised_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a href="#id14"><span class="problematic" id="id15">std_data_</span></a> object pd.DataFrame.</p>
</dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.Dataset.std_data_">
<code class="sig-name descname">std_data_</code><em class="property">: pandas.core.frame.DataFrame</em><em class="property"> = None</em><a class="headerlink" href="#backend.datasets.dataset.Dataset.std_data_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="backend.datasets.dataset.Dataset.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backend.datasets.dataset.Dataset.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the standardised data to csv in the cleaned folder, using naming convention
of resolution_name.csv. If the same file already exists it will not write.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the data has not already been standardised.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="backend.datasets.dataset.MasterDataset">
<em class="property">class </em><code class="sig-prename descclassname">backend.datasets.dataset.</code><code class="sig-name descname">MasterDataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">datasets</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference internal" href="#backend.datasets.dataset.Dataset" title="backend.datasets.dataset.Dataset">backend.datasets.dataset.Dataset</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">res</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#backend.datasets.dataset.DataResolution" title="backend.datasets.dataset.DataResolution">backend.datasets.dataset.DataResolution</a></span></em>, <em class="sig-param"><span class="n">freq</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#backend.datasets.dataset.DataFrequency" title="backend.datasets.dataset.DataFrequency">backend.datasets.dataset.DataFrequency</a></span></em>, <em class="sig-param"><span class="n">from_csv</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#backend.datasets.dataset.MasterDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Used to call or generate the merged ‘master’ dataset used
to write to json. Can be used to generate the ‘live’ or ‘static’
master datasets. Will write out to csv if it does not already exist,
or if user chooses ‘from_csv’ to be False.</p>
<p class="rubric">Notes</p>
<p>When the master dataset is created, certain data transformation are assumed,
which create variables from expected columns in LSOA/LA STATIC or LIVE datasets.
These are detailed in the _create_master_dataset method.</p>
<dl class="py attribute">
<dt id="backend.datasets.dataset.MasterDataset.datasets">
<code class="sig-name descname">datasets</code><a class="headerlink" href="#backend.datasets.dataset.MasterDataset.datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of Dataset instances to be merged into the master dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#backend.datasets.dataset.Dataset" title="backend.datasets.dataset.Dataset">Dataset</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.MasterDataset.res">
<code class="sig-name descname">res</code><a class="headerlink" href="#backend.datasets.dataset.MasterDataset.res" title="Permalink to this definition">¶</a></dt>
<dd><p>The DataResolution of the data. Accepts LA or LSOA.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>DataResoltion</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.MasterDataset.freq">
<code class="sig-name descname">freq</code><a class="headerlink" href="#backend.datasets.dataset.MasterDataset.freq" title="Permalink to this definition">¶</a></dt>
<dd><p>The DataFrequency of the data. Accepts STATIC or LIVE.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#backend.datasets.dataset.DataFrequency" title="backend.datasets.dataset.DataFrequency">DataFrequency</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.MasterDataset.from_csv">
<code class="sig-name descname">from_csv</code><a class="headerlink" href="#backend.datasets.dataset.MasterDataset.from_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the master dataset should be built from previously generated csv.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">master_dataset\_</code></dt>
<dd><p>The final merged dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id8">
<code class="sig-name descname">datasets</code><em class="property">: List[Dataset]</em><em class="property"> = None</em><a class="headerlink" href="#id8" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="backend.datasets.dataset.MasterDataset.file_path">
<em class="property">property </em><code class="sig-name descname">file_path</code><a class="headerlink" href="#backend.datasets.dataset.MasterDataset.file_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns str filepath to write csv to, based on freq and res</p>
</dd></dl>

<dl class="py attribute">
<dt id="id9">
<code class="sig-name descname">freq</code><em class="property">: DataFrequency</em><em class="property"> = None</em><a class="headerlink" href="#id9" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id10">
<code class="sig-name descname">from_csv</code><em class="property">: bool</em><em class="property"> = True</em><a class="headerlink" href="#id10" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="backend.datasets.dataset.MasterDataset.master_dataset">
<em class="property">property </em><code class="sig-name descname">master_dataset</code><a class="headerlink" href="#backend.datasets.dataset.MasterDataset.master_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the master dataset, and generates it if it does not exist.</p>
</dd></dl>

<dl class="py attribute">
<dt id="backend.datasets.dataset.MasterDataset.master_dataset_">
<code class="sig-name descname">master_dataset_</code><em class="property">: pandas.core.frame.DataFrame</em><em class="property"> = None</em><a class="headerlink" href="#backend.datasets.dataset.MasterDataset.master_dataset_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id11">
<code class="sig-name descname">res</code><em class="property">: DataResolution</em><em class="property"> = None</em><a class="headerlink" href="#id11" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="backend.datasets.dataset.MasterDataset.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="headerlink" href="#backend.datasets.dataset.MasterDataset.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes data to csv on the given filepath.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-backend.datasets.live">
<span id="live"></span><h2>live<a class="headerlink" href="#module-backend.datasets.live" title="Permalink to this headline">¶</a></h2>
<p>Handles live data from reading to master dataset generation.</p>
<p>This module reads, standardises and defines the master dataset for data sources
from the data/live folder.</p>
<p class="rubric">Notes</p>
<p>This module imports classes from the <cite>dataset</cite> module.
The <cite>LA_LIVE</cite> master dataset definition has <cite>from_csv=False</cite>. This means that the
live dataset master will always be regenerated from the source files given here,
rather than read from the existing master csv.</p>
<p>To add a new live datasource, follow the existing examples for a <cite>SOURCE_</cite> constant
that is read from file, passed to a <cite>Dataset</cite> definition, and then the Dataset
definition defined in the <cite>LA_LIVE</cite> datasets list to ensure it is included.</p>
</div>
<div class="section" id="module-backend.datasets.static">
<span id="static"></span><h2>static<a class="headerlink" href="#module-backend.datasets.static" title="Permalink to this headline">¶</a></h2>
<p>Module that generates the cleaned datasets for each variable from raw.</p>
<p>This module standardises and defines the master dataset for data sources
from the data/static folder.</p>
<p class="rubric">Notes</p>
<p>This module imports classes from the <cite>dataset</cite> module, and source dataset
constants from the <cite>static_source_datasets</cite> module.</p>
<p>To add a new datasource, follow the existing examples for a <cite>SOURCE_</cite> constant
that is passed to a <cite>Dataset</cite> definition, and then add the Dataset
constant to the MasterDataset datasets list to ensure it is included.</p>
<p>The <cite>LSOA_STATIC</cite> and <cite>LA_STATIC</cite> master datasets have <cite>from_csv=True</cite>. This means
that the master datasets will always be read from a previously generated master csv,
rather than regenerated from source files. If new sources are added, this will need
to be run at least once with <cite>from_csv=False</cite> to integrate new sources into a new
master csv.</p>
</div>
<div class="section" id="module-backend.datasets.static_source_datasets">
<span id="static-source-datasets"></span><h2>static_source_datasets<a class="headerlink" href="#module-backend.datasets.static_source_datasets" title="Permalink to this headline">¶</a></h2>
<p>Handles reading of datasets from static source data folder.</p>
</div>
<div class="section" id="module-backend.datasets.generate_gp_online">
<span id="generate-gp-online"></span><h2>generate_gp_online<a class="headerlink" href="#module-backend.datasets.generate_gp_online" title="Permalink to this headline">¶</a></h2>
<p>Generates gp_online.csv</p>
<p>Functions contained in this module take data of patients registered with My Health Online from local
data folders. The <cite>gp_to_area</cite> function matches each GP practice to a postcode, and then matches that
postcode to a Local Authority, Lower Super Output Area and Middle Super Output Area.</p>
<p>The <cite>mhol_to_percentage</cite> function then calculates the overall percentage of patients registered online
at the area level chosen.</p>
<p>To run, these functions require local data that is not published in the repository.</p>
<dl class="py function">
<dt id="backend.datasets.generate_gp_online.gp_to_area">
<code class="sig-prename descclassname">backend.datasets.generate_gp_online.</code><code class="sig-name descname">gp_to_area</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gp_data</span></em>, <em class="sig-param"><span class="n">postcode_lookup</span></em>, <em class="sig-param"><span class="n">gp_lookup</span></em><span class="sig-paren">)</span><a class="headerlink" href="#backend.datasets.generate_gp_online.gp_to_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Using data and lookup tables, generates a new dataframe with the LA and LSOA
matched to each GP practice code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gp_data</strong> (<em>pd.DataFrame</em>) – Data on number of patients per GP practice. Should contain cols <cite>GP Practice Code</cite>,
<cite>MHOL patient count</cite>, <cite>Patients (2019)</cite>.</p></li>
<li><p><strong>postcode_lookup</strong> (<em>pd.DataFrame</em>) – A df with a column of postcodes (<cite>pscds</cite>) and columns matching each postcode to an
LSOA, LA and MSOA area.</p></li>
<li><p><strong>gp_lookup</strong> (<em>pd.DataFrame</em>) – A df with a column of GP practice IDs (<cite>practice_ID</cite>) and postcodes (<cite>postcode</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A df where each row is a GP practice matched to a postcode, LA, LSOA and MSOA, along
with associated data columns from <cite>gp_data</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="backend.datasets.generate_gp_online.mhol_to_pct">
<code class="sig-prename descclassname">backend.datasets.generate_gp_online.</code><code class="sig-name descname">mhol_to_pct</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">res</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#backend.datasets.dataset.DataResolution" title="backend.datasets.dataset.DataResolution">backend.datasets.dataset.DataResolution</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#backend.datasets.generate_gp_online.mhol_to_pct" title="Permalink to this definition">¶</a></dt>
<dd><p>For a dataframe with rows of each GP practice mapped to LA or LSOA codes and names,
sums “patients_total” and “MHOL_true” across area, and creates new col with total percentage
over each LA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – <dl class="simple">
<dt>Each row is a unique GP practice with an area code and name, and</dt><dd><p><cite>patients_total</cite> and <cite>MHOL_true</cite> columns.</p>
</dd>
</dl>
</p></li>
<li><p><strong>res</strong> (<a class="reference internal" href="#backend.datasets.dataset.DataResolution" title="backend.datasets.dataset.DataResolution"><em>DataResolution</em></a><em>, </em><em>optional</em>) – The area resolution of the data, specified using the DataResolution class that is imported
from the <cite>dataset</cite> module. By default DataResolution.LA</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns df with rows as each area with sum of “patients_total”,
“MHOL_true” and new col “MHOL_pct” which is the percentage of MHOL_true out of patients_total.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="backend.scrapers.html" class="btn btn-neutral float-right" title="Package: backend.scrapers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="backend.html" class="btn btn-neutral float-left" title="Package: backend" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Nina Di Cara, Chris Moreno-Stokoe, Oliver Davis, Valerio Maggio, Benjamin Woolf

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>